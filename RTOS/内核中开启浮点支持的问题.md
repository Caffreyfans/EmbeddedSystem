# 在内核中开启浮点支持的说明

如果想在宏内核版本的 rtos 中进行浮点运算，就需要在移植时支持浮点，并且在编译和链接的时候开启浮点支持选项。

移植时处理浮点的问题，至少要处理两种情况：

1. 只是发生中断，而不进行线程切换时，只需要在发生中断时，将所有的寄存器（包括浮点寄存器） push 到中断栈中，在中断退出时，从中断栈中恢复先前线程上下文的寄存器组。

2. 如果是需要进行线程切换的情况，发生中断的时候，需要将所有的寄存器（包括浮点寄存器） push 到中断栈中，然后进行中断处理，最后在切换到新线程之前，将保存在中断栈中的当前线程的 context 拷贝到线程的栈的对应位置中。

这两者的区别是，第一种情况将中断栈里保存的上下文直接恢复到寄存器组里，第二种情况是将在中断栈里保存的上下文再次保存到当前线程栈中对应的位置上。

